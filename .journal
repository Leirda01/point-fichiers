#!/usr/bin/bash

if [[ $1 ]]; then
  date=${1%%.*}
else
  if [[ $(date +%H) -lt 3 ]]; then
    date=$(date --date="yesterday" +%Y/%m/%d)
  else
    date=$(date +%Y/%m/%d)
  fi
fi

mkdir -p "$HOME/saveuriendir/$date"

echo -n "Page à ouvrir ? "
read journal

[[ "$journal" = \n ]] && journal="main"
journal="$HOME/saveuriendir/$date/$journal.md"

[[ -O "$journal" ]] && chmod u+w "$journal"
vim "$journal"
[[ -w "$journal" ]] && chmod u-w "$journal"

[[ -s "$journal" ]] || rm -f "$journal"
